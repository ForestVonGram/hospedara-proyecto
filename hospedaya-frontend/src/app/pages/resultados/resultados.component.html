<div class="dashboard">
  <app-header></app-header>

  <section class="welcome">
    <div class="search">
      <div>
        <label>Destino</label>
        <input placeholder="¬øA d√≥nde vas?" [(ngModel)]="destino" (ngModelChange)="aplicarFiltros()" />
      </div>
      <div>
        <label>Check-in</label>
        <input type="date" [(ngModel)]="checkin" />
      </div>
      <div>
        <label>Check-out</label>
        <input type="date" [(ngModel)]="checkout" />
      </div>
      <div>
        <label>Hu√©spedes</label>
        <select [(ngModel)]="huespedes">
          <option *ngFor="let n of [1,2,3,4,5,6,7,8]" [value]="n">{{n}}</option>
        </select>
      </div>
      <button (click)="aplicarFiltros()">Buscar Alojamientos</button>
    </div>
  </section>

  <div class="content">
    <aside class="filters">
      <h3>Filtros</h3>
      <div class="price-range">
        <div class="field">
          <label>Precio m√≠nimo (COP)</label>
          <input type="number" min="0" step="50" [(ngModel)]="minPrecio" (ngModelChange)="aplicarFiltros()" placeholder="Sin l√≠mite" />
        </div>
        <div class="field">
          <label>Precio m√°ximo (COP)</label>
          <input type="number" min="0" step="50" [(ngModel)]="maxPrecio" (ngModelChange)="aplicarFiltros()" placeholder="Sin l√≠mite" />
        </div>
        <small class="hint">Deja en blanco para "Sin l√≠mite". Los valores se interpretan en COP.</small>
      </div>
    </aside>

    <section class="destacados">
      <div class="results-header">
        <h3>{{ filtrados.length }} alojamientos encontrados</h3>
        <button class="btn-toggle-map" (click)="toggleMapView()">
          {{ showMap ? 'üìã Mostrar lista' : 'üó∫Ô∏è Mostrar mapa' }}
        </button>
      </div>

      <!-- Mapa -->
      <div *ngIf="showMap" class="map-container">
        <div id="map-resultados" class="map-resultados"></div>
      </div>

      <!-- Grid de alojamientos -->
      <div class="grid" *ngIf="!showMap">
        <article class="card" *ngFor="let a of filtrados">
          <a [routerLink]="['/alojamientos', a.id]">
            <img [src]="resolverImg(a)" alt="Imagen del alojamiento" />
          </a>
          <div class="info">
            <h4><a [routerLink]="['/alojamientos', a.id]">{{ a.titulo }}</a></h4>
            <p>{{ a.direccion }}</p>
            <div class="meta">
              <span>{{ a.precioPorNoche | currency:'COP':'symbol-narrow':'1.0-0':'es-CO' }}/noche</span>
              <span>‚òÖ 4.7</span>
            </div>
            <div class="actions">
              <a class="btn" [routerLink]="['/alojamientos', a.id]">Ver detalles</a>
              <button class="btn" [routerLink]="['/alojamientos', a.id, 'reservar']">Reservar</button>
            </div>
          </div>
        </article>
      </div>
    </section>
  </div>
</div>
