<!-- Detalle de Alojamiento -->
<section class="listing-detail" *ngIf="!loading && !error; else estado">
  <!-- Galería -->
  <div class="gallery" *ngIf="alojamiento as a">
    <figure class="gallery__main">
      <img [src]="resolverImg(a.imagenes && a.imagenes[0])" alt="Foto principal del alojamiento" />
    </figure>
    <div class="gallery__thumbs" *ngIf="a.imagenes && a.imagenes.length > 1">
      <img *ngFor="let img of a.imagenes.slice(1,5)" [src]="resolverImg(img)" alt="Imagen del alojamiento" />
    </div>
  </div>

  <!-- Título + meta -->
  <header class="listing-header" *ngIf="alojamiento as a">
    <h1 class="listing-title">{{ a.titulo }}</h1>
    <div class="listing-meta">
      <span class="meta-item">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M12 22s7-5.686 7-12a7 7 0 1 0-14 0c0 6.314 7 12 7 12Z" stroke="currentColor" stroke-width="1.6"/><circle cx="12" cy="10" r="3" stroke="currentColor" stroke-width="1.6"/></svg>
        {{ a.direccion }}
      </span>
      <span class="meta-item rating">
        <span class="stars" aria-label="4.8 de 5">
          <svg viewBox="0 0 20 20" width="16" height="16" fill="#f59e0b" aria-hidden="true"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 0 0 .95.69h3.464c.969 0 1.371 1.24.588 1.81l-2.803 2.036a1 1 0 0 0-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.538 1.118l-2.803-2.036a1 1 0 0 0-1.176 0l-2.803 2.036c-.783.57-1.838-.197-1.538-1.118l1.07-3.292a1 1 0 0 0-.364-1.118L2.977 8.72c-.783-.57-.38-1.81.588-1.81H7.03a1 1 0 0 0 .95-.69l1.07-3.292Z"/></svg>
          <svg viewBox="0 0 20 20" width="16" height="16" fill="#f59e0b" aria-hidden="true"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 0 0 .95.69h3.464c.969 0 1.371 1.24.588 1.81l-2.803 2.036a1 1 0 0 0-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.538 1.118l-2.803-2.036a1 1 0 0 0-1.176 0l-2.803 2.036c-.783.57-1.838-.197-1.538-1.118l1.07-3.292a1 1 0 0 0-.364-1.118L2.977 8.72c-.783-.57-.38-1.81.588-1.81H7.03a1 1 0 0 0 .95-.69l1.07-3.292Z"/></svg>
          <svg viewBox="0 0 20 20" width="16" height="16" fill="#f59e0b" aria-hidden="true"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 0 0 .95.69h3.464c.969 0 1.371 1.24.588 1.81l-2.803 2.036a1 1 0 0 0-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.538 1.118l-2.803-2.036a1 1 0 0 0-1.176 0l-2.803 2.036c-.783.57-1.838-.197-1.538-1.118l1.07-3.292a1 1 0 0 0-.364-1.118L2.977 8.72c-.783-.57-.38-1.81.588-1.81H7.03a1 1 0 0 0 .95-.69l1.07-3.292Z"/></svg>
          <svg viewBox="0 0 20 20" width="16" height="16" fill="#f59e0b" aria-hidden="true"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 0 0 .95.69h3.464c.969 0 1.371 1.24.588 1.81l-2.803 2.036a1 1 0 0 0-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.538 1.118l-2.803-2.036a1 1 0 0 0-1.176 0l-2.803 2.036c-.783.57-1.838-.197-1.538-1.118l1.07-3.292a1 1 0 0 0-.364-1.118L2.977 8.72c-.783-.57-.38-1.81.588-1.81H7.03a1 1 0 0 0 .95-.69l1.07-3.292Z"/></svg>
          <svg viewBox="0 0 20 20" width="16" height="16" fill="#f59e0b" aria-hidden="true"><defs><linearGradient id="half"><stop offset="50%" stop-color="#f59e0b"/><stop offset="50%" stop-color="#e5e7eb"/></linearGradient></defs><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 0 0 .95.69h3.464c.969 0 1.371 1.24.588 1.81l-2.803 2.036a1 1 0 0 0-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.538 1.118l-2.803-2.036a1 1 0 0 0-1.176 0l-2.803 2.036c-.783.57-1.838-.197-1.538-1.118l1.07-3.292a1 1 0 0 0-.364-1.118L2.977 8.72c-.783-.57-.38-1.81.588-1.81H7.03a1 1 0 0 0 .95-.69l1.07-3.292Z" fill="url(#half)"/></svg>
        </span>
        <span class="rating-text">4.8 <span class="reviews">(120 reseñas)</span></span>
      </span>
    </div>
  </header>

  <div class="content" *ngIf="alojamiento as a">
    <!-- Columna izquierda -->
    <div class="left">
      <section class="card">
        <h2>Descripción</h2>
        <p>
          {{ a.descripcion }}
        </p>
        <ul class="facts">
          <li>
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3 10a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v7H3v-7Z" stroke="currentColor" stroke-width="1.6"/><path d="M7 8V7a5 5 0 0 1 10 0v1" stroke="currentColor" stroke-width="1.6"/></svg>
            Alojamiento completo
          </li>
          <li>
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4 20v-2a4 4 0 0 1 4-4h8a4 4 0 0 1 4 4v2" stroke="currentColor" stroke-width="1.6"/><circle cx="12" cy="7" r="3" stroke="currentColor" stroke-width="1.6"/></svg>
            Huéspedes: 4+
          </li>
          <li>
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4 20V7l8-4 8 4v13" stroke="currentColor" stroke-width="1.6"/><path d="M9 20v-6h6v6" stroke="currentColor" stroke-width="1.6"/></svg>
            Habitaciones: 2+
          </li>
          <li>
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M7 11h10M6 15h12M9 7h6" stroke="currentColor" stroke-width="1.6"/></svg>
            Baños: 1+
          </li>
        </ul>
      </section>

      <section class="card">
        <h3>Servicios incluidos</h3>
        <ul class="services">
          <li><span class="check"></span> Wi‑Fi</li>
          <li><span class="check"></span> Cocina equipada</li>
          <li><span class="check"></span> Aire acondicionado</li>
          <li><span class="check"></span> TV</li>
          <li><span class="check"></span> Ropa de cama</li>
          <li><span class="check"></span> Toallas</li>
        </ul>
      </section>
    </div>

    <!-- Columna derecha -->
    <aside class="right">
      <div class="booking card">
        <div class="price">
          <span class="amount">${{ a.precioPorNoche }}</span>
          <span class="per">/ noche</span>
        </div>
        <div class="availability">
          <h4>Disponibilidad</h4>
          <div class="dates">
            <div class="date">
              <span class="label">Check-in</span>
              <span class="value">Seleccione fecha</span>
            </div>
            <div class="date">
              <span class="label">Check-out</span>
              <span class="value">Seleccione fecha</span>
            </div>
          </div>
        </div>
        <button class="reserve-btn" type="button" [routerLink]="['/alojamientos', a.id, 'reservar']">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M5 12h14M12 5l7 7-7 7" stroke="#fff" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
          Reservar ahora
        </button>
        <p class="disclaimer">No se cobrará nada todavía</p>
      </div>
    </aside>
  </div>
</section>

<ng-template #estado>
  <div class="listing-detail">
    <p *ngIf="loading">Cargando alojamiento...</p>
    <div *ngIf="error" class="card" style="border-color:#fecaca; background:#fff1f2;">
      <p>{{ error }}</p>
      <a routerLink="/" style="color:#be123c; font-weight:600;">Volver al inicio</a>
    </div>
  </div>
</ng-template>
