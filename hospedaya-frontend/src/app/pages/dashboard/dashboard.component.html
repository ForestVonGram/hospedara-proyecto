<app-header></app-header>

<div class="dashboard">

  <section class="welcome">
    <h2>Bienvenido, {{ user?.nombre || 'Usuario' }}</h2>
    <p>Encuentra tu próximo hospedaje ideal</p>

    <div class="search">
      <input placeholder="¿A dónde vas?" [(ngModel)]="destino" />
      <input type="date" [(ngModel)]="checkin" />
      <input type="date" [(ngModel)]="checkout" />
      <select [(ngModel)]="huespedes">
        <option *ngFor="let n of [1,2,3,4,5,6,7,8]" [value]="n">{{n}}</option>
      </select>
      <button (click)="buscar()">Buscar</button>
    </div>
  </section>

  <section class="destacados">
    <h3>{{ (recomendados && recomendados.length) ? 'Recomendados para ti' : 'Alojamientos Destacados' }}</h3>
    <div *ngIf="loadingAlojamientos">Cargando alojamientos...</div>
    <div *ngIf="errorAlojamientos" class="error">{{ errorAlojamientos }}</div>
    <div class="grid" *ngIf="!loadingAlojamientos && !errorAlojamientos">
      <ng-container *ngIf="(recomendados && recomendados.length) || alojamientos.length; else noAlojamientos">
        <article class="card" *ngFor="let a of (recomendados.length ? recomendados : alojamientos)">
          <img [src]="imagenPrincipal(a)" alt="Imagen de {{ a.titulo }}" (click)="verDetalle(a)" style="cursor:pointer" />
          <div class="info">
            <h4 (click)="verDetalle(a)" style="cursor:pointer">{{ a.titulo }}</h4>
            <p class="direccion">{{ a.direccion }}</p>
            <div class="meta">
              <span>${{ a.precioPorNoche }}/noche</span>
            </div>
            <div class="actions" style="display:flex; gap:8px;">
              <button (click)="verDetalle(a)">Ver detalle</button>
              <button (click)="reservar(a)">Reservar</button>
            </div>
          </div>
        </article>
      </ng-container>
      <ng-template #noAlojamientos>
        <p>No hay alojamientos disponibles por ahora.</p>
      </ng-template>
    </div>
  </section>

  <section class="mapa">
    <h3>Explora el mapa</h3>
    <app-dashboard-map></app-dashboard-map>
  </section>
</div>
