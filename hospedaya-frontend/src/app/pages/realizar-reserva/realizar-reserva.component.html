<app-header></app-header>

<div style="padding: 12px 16px;">
  <a [routerLink]="['/alojamientos', alojamientoId]" class="btn btn-primary" *ngIf="alojamientoId">Volver al detalle</a>
</div>

<!-- CONTENIDO PRINCIPAL -->
<main class="contenedor" *ngIf="!cargando">
  <h1>Reserva en {{ alojamiento?.titulo || 'Alojamiento' }}</h1>

  <form class="form-reserva" [formGroup]="form" (ngSubmit)="confirmarReserva()">
    <div class="fechas">
      <div class="campo">
        <label for="entrada">Fecha de entrada</label>
        <input type="date" id="entrada" formControlName="fechaInicio" [min]="todayStr()" (change)="ajustarMinCheckout()">
      </div>

      <div class="campo">
        <label for="salida">Fecha de salida</label>
        <input type="date" id="salida" formControlName="fechaFin" [min]="minCheckoutStr()">
      </div>
    </div>

    <div class="campo">
      <label for="huespedes">Número de huéspedes</label>
      <select id="huespedes" formControlName="huespedes">
        <option *ngFor="let n of huespedesOpciones()" [value]="n">{{ n }} huésped{{ n>1 ? 'es' : '' }}</option>
      </select>
      <small class="error" *ngIf="form.get('huespedes')?.touched && form.get('huespedes')?.invalid">Cantidad de huéspedes inválida.</small>
    </div>

    <div class="campo resumen">
      <label>Resumen de precio</label>
      <div class="box-resumen">
        Total: <span class="precio">{{ total() | currency:'USD':'symbol' }}</span>
        por {{ noches() }} noche(s)
      </div>
    </div>

    <div *ngIf="error" style="color:#b91c1c; margin: .5rem 0;">{{ error }}</div>
    <div *ngIf="exito" style="color:#16a34a; margin: .5rem 0;">{{ exito }}</div>

    <button type="submit" class="btn-confirmar" [disabled]="form.invalid || noches() <= 0">
      ✅ Confirmar Reserva
    </button>

    <p class="cancelacion">
      Podrás cancelar gratis hasta 48 horas antes de tu llegada.
    </p>
  </form>
</main>
<div *ngIf="cargando" class="contenedor">Cargando...</div>
